# 缓存

动静分离，分级缓存，主动失效。

## 模板语法

Mustache、jade、hbs 

## 缓存机制

一般会有主动失效和自动失效缓存机制。
* 主动更新一般会用 API 调用方式实现。比如删除 key,或者调用 CDN 接口进行删除操作

缓存穿透：一般会在第一次请求的时候生成缓存，如果服务器端没有缓存，然后在同一时刻出现高并发请求，请求会直接到达业务逻辑部分，很可能导致系统直接挂掉。 

* 主动创建缓存。缓存求由系统定时创建。
* 请求的时候设置标志位。第一个请求到达，标识这个 url 正在创建缓存，其他请求进入等待队列。

在 CDN 配置自主源站。意味着请求 CDN 地址的时候，CDN 会去源站请求数据，然后缓存到 CDN 节点。

cname www.localhost.com 到 CDN 提供的空间域名

平台的识别来自 UserAgent，不同的浏览器或者 app，都有不同的UserAgent。不同的来源我们称之为 Origin。Origin + url 就可以生成唯一的 key，去识别唯一的缓存。缓存不限于 redis 和 文件缓存。

## 分类

* 操作系统缓存：减少池畔机械操作
* 数据库缓存：减少文件系统I/O
* 应用程序缓存：减少数据库的查询
* Web服务器缓存：减少应用服务器请求
* 客户端浏览器缓存：减少对网站的访问