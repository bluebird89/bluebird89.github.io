# 代码审查

一项确保软件质量的活动，是由一个或多个人通过查看和阅读部分源代码来检查程序的一种方式，代码审查通常发生在实现完成后或实现中间阶段。参与审查的人员中必须至少有一人不是代码的作者。执行审查的人员称之为“审查人”，但不包含作者本人。

* 提高代码质量
* 保持项目的一致性
* 发现 bug
* 学习（通过代码被审查）和教学（通过审查其他人的代码）
* 营造共同的责任感
* 通过他方查找代码中的小错误，防止这些小错误日积月累腐蚀代码
* 寻找更好的解决方案的常见方法

## 被审查者

* 代码审查不是为了评判或审查某个人的编程能力。“代码审查只关注代码”
* 避免
    - 将重构的代码和新代码的实现混合在一起
    - 在提交功能变更时，重新格式化整个代码库
    - 提交代码时不写提交注释（我会在后面讨论该话题）
    - 在一次代码审核（或一次代码提交）中提交多个功能
* 注意
    - 单独提交代码清理命令（重新格式化或修复拼写错误等）和重构:代码是否与提交注释相符
    - 编写相关的提交说明
    - 只提交准备好审查的代码
    - 审查期间不要更改代码
    - 确保你的代码通过了自己的审查，并且你没有发现任何明显的问题，可以放心地合并代码（如果你发现了问题，并想讨论某些内容，那么提前跟你的审核者打招呼）；
    - 代码中没有混合不相干的变更，不会太长也不会增加阅读难度；
    - 针对代码变更写好提交注释，明确交待变更的目的
* 快速完成功能，大家写代码的时候都没有思考太多 =》 自己的代码马上就要被别人审视， 就像开源软件一样，写得小心翼翼了


```md
XXX：添加一些新功能（简短的说明）

对于代码实现更为详细的描述
你可以写很多行，但还可以包括：
* 项目符号
* 不同的细节
* 如果你有很多点，一行写不下，那么也可以在各个点之间插入空行

引用与之相关的问题
```

## 审查者

* 性能（如果是在同一个代码库的话，通常不那么重要）
* 可读性（恕我直言，这几乎是最重要的）
* 尝试覆盖比被审查的解决方案更多的极端情况
* 是否可以用更好的代码样式（比如更多可重用的代码）来实现相同的功能
* 代码测试
    - 验证它们是否在测试正确的东西
    - 变更后的 API 的使用方法以及测试用例是否合理。
    - 通过单元测试我们就能看出实现的使用方法。
* 安全：代码都需要拥有某种安全机制（例如 OAUTH 层，或 REST 控制器的 BASIC
* 保持友好
* 审查代码，而不是写代码的人
* 评语要简洁准确
* 在最后不要忘了为好的代码点赞
* 表明你是否需要等代码修改完毕后再看一次（如果你们的审查工具不支持这一功能的话）

## 工具

* Phabricator
* ReviewNinja
* Codacy
* RhodeCode
* Gerrit

## 方法

* CheckStyle
* Check List
* 小步快跑：控制每次Review代码的数量

