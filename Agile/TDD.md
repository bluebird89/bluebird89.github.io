# TDD 测试驱动开发

* 敏捷开发中的一项核心实践和技术，也是一种设计方法论
* 原理是在开发功能代码之前，先编写单元测试用例代码，测试代码确定需要编写什么产品代码
    - 分离关注点，一次只戴一顶帽子
    - 只在没有信心的地方写测试代码
    - 红：写一个失败的测试，它是对一个小需求的描述，只需要关心输入输出，这个时候根本不用关心如何实现。
    - 绿：专注在用最快的方式实现当前这个小需求，不用关心其他需求，也不要管代码的质量多么惨不忍睹。
    - 重构：既不用思考需求，也没有实现的压力，只需要找出代码中的坏味道，并用一个手法消除它，让代码变成整洁的代码。
* XP（Extreme Programming）的核心实践
* 分类
    - UTDD（Unit Test Driven Development）
    - ATDD（Acceptance Test Driven Development），包括 BDD（Behavior Driven Development）和 Consumer-Driven Contracts Development
* 三层含义
    - Test-Driven Development，测试驱动开发。
    - Task-Driven Development，任务驱动开发，要对问题进行分析并进行任务分解。
    - Test-Driven Design，测试保护下的设计改善。TDD 并不能直接提高设计能力，它只是给你更多机会和保障去改善设计。
* 流程
    - 先分解任务，分离关注点
    - 列 Example，用实例化需求，澄清需求细节
    - 写测试，只关注需求，程序的输入输出，不关心中间过程
    - 写实现，不考虑别的需求，用最简单的方式满足当前这个小需求即可
    - 重构，用手法消除代码里的坏味道
    - 写完，手动测试一下，基本没什么问题，有问题补个用例，修复
    - 转测试，小问题，补用例，修复
    - 代码整洁且用例齐全
* 优点
    - 降低开发者负担：通过明确的流程，让我们一次只关注一个点，思维负担更小。
    - 保护网：TDD 的好处是覆盖完全的单元测试，对产品代码提供了一个保护网，让我们可以轻松地迎接需求变化或改善代码的设计。所以如果你的项目需求稳定，一次性做完，后续没有任何改动的话，能享受到 TDD 的好处就比较少了。
    - 提前澄清需求：先写测试可以帮助我们去思考需求，并提前澄清需求细节，而不是代码写到一半才发现不明确的需求。
    - 快速反馈：有很多人说 TDD 时，我的代码量增加了，所以开发效率降低了。但是，如果没有单元测试，你就要手工测试，你要花很多时间去准备数据，启动应用，跳转界面等，反馈是很慢的。准确说，快速反馈是单元测试的好处。
* 方式：红，绿，重构
    - 写一个测试用例
    - 运行测试
    - 写刚好能让测试通过的实现
    - 运行测试
    - 识别坏味道，用手法修改代码
    - 运行测试
* 规则
    - 除非是为了使一个失败的 unit test 通过，否则不允许编写任何产品代码
    - 在一个单元测试中，只允许编写刚好能够导致失败的内容（编译错误也算失败）
    - 只允许编写刚好能够使一个失败的 unit test 通过的产品代码
* 单元测试应该符合几条原则：
    - 简单，只测试一个需求
    - 符合 Given-When-Then 格式
    - 速度快
    - 包含断言
* 问题
    - 不会合理拆分任务
    - 不会写测试
    - 不会写刚好的实现
    - 不会重构
    - 有没有Tasking?
        + 将一个原本的较大的需求，分解成一个个很小的需求,往往是非常容易的。通过这样的方式，可以缩短我们红绿重构的周期，得到快速的反馈
    - 有没有选择最简单的Task先做？

## TDD

* 掌握测试驱动开发的方法，练好基本功、改进工作方式，提高开发效率
* 项目：
    - 要求
        + 代码整洁，没有重复代码
        + 有单元测试，单元测试覆盖率100%
        + 10分钟内完成
    - 技能点
        + JUnit单元测试
        + 测试驱动开发
        + IDEA快捷键
    - 能力目标
        + IDE的快捷键操作
        + 用JUnit编写单元测试
        + 编写失败的测试，驱动出产品代码
        + 充分利用代码生成
        + 刻意练习的节奏
