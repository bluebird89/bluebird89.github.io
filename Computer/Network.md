# NetWork

* 硬件网卡，网线，交换机这些，用来处理数据的。
* 协议数据在网络中通信如何组织？如何识别？如何保证数据的正确性
* 操作系统这就是如何把计算机网络和操作系统结合起来的问题了
    - 对于操作系统来说，网卡也是一种硬件资源。但是网络不单只是一种硬件，而是一种媒体入口。比如操作系统管理硬盘，当然不是简单的记一下硬盘有多大，然后一切操作都交给硬盘芯片去做，更多的需要组织硬盘的扇区，分区，记录文件和扇区/偏移的关系等等。
    - 操作系统对于网络来说也是如此，要记录自身在网络的标识（ip），可被他人访问的入口（port），以及对方的信息（remote ip/port）。连接，断开，数据确认等操作也是由协议控制。传递自身消息给对方，类似访问硬盘一样把内存中的数据传递给网卡缓存，再发消息给网卡让网卡去传数据，而是否发送成功这些保证不再由硬件中断信号反馈，而是通过网络协议完成。接收对方消息，也是接收到网卡中断，再把数据从网卡缓存移动到内存中，再通过协议给予对方反馈。

## 网络

* 集线器（Hub）：一个将网线集结起来的作用，实现最初级的网络互通。集线器是通过网线直接传送数据的，工作在物理层
* 交换机：给这台设备加入一个指令，可以根据网口名称自动寻址传输数据。实现了任意两台电脑间的互联。工作在数据链路层。
    - 保存的是每个计算机的网卡MAC地址与你所在的计算机的接口：通过学习，可以把MAC地址，端口号完善
    - 既可以连接PC机，又可以连接路由器
    - 根据Mac地址表转发数据
    - mac地址表含有Mac地址和接口
* 路由器：先在各自的操作系统上加上一套相同的协议。不同村落通信时，信息经协议加工成统一形式，再经由一个特殊的设备传送出去。这个设备就叫做路由器。每个机器都被赋予了一个IP地址。协议便是TCP/IP协议簇。
    - 是用来互联不同网段的设备。根据路由表转发数据
    - 理由表中含有网段和接口（！！！注意：绝对不能把路由器接在两个相同的网段上。）
* ARP协议：它是一种广播，通过ip地址得到MAC地址的广播协议。
    - 代理ARP工作原理：路由器可以分割网段和广播，比如广播后只能在同一个网段接收到，而在其他的网段不会听见广播。

```
arp -a
```

## 网络数据转发原理

网络OSI七层模型

* 物理层：通信线缆（光缆、无线），线缆的标准统统属于物理层
* 数据链路层：完成加封（盖个戳，加个标记）与解封、数据量层:加封：盖个戳，加个标记， 数据链路层重点是在数据包外部加一个原MAC地址，目标Mac地址的这么一个标记。mac地址：网卡的物理地址，也是网卡的实际地址。 加原Mac地址+目的mac地址。mac地址不能改变，在电脑出厂时已经刷在了网卡上了，Mac地址犹如身份证的ID是唯一的。
    - MAC地址：介质访问控制（Media Access Control）
* 网络层：ip地址层 网络层+ip 地址层 在数据外围加一个原ip地址和目的ip地址
    - IP（Internet Protocol）互联网协议
        - IP主要解决三个问题：寻址、路由、封装；
        - 分为两部分：网络地址+主机地址
        - 子网掩码：TCP/IP协议使用子网掩码确定主机是在本地子网中还是在远程网络中。将Ip地址和子网掩码排在一起比较，就可以分清楚改地址的网络部分和主机部分
* 传输层：在原有的上层的数据外围标记两个标签：第一源端口，第二目的端口，从这个端口出去，访问另一个端口
    * TCP（Transmission Control Protocol）传输控制协议
* 会话层：通讯状态,下面三层由人与应用程序完成
* 表示层：上传的数据是以什么样的编码来编码，编码状态和回话方式，不是以人来自定义来完成的，而是由人在应用层操作来完成的
* 应用层：通讯软件，人参与的都是在应用层，其他的都是由软件来完成

![七层协议](../_static/osi_1.png "Optional title")
![数据流](../_static/osi2.png "Optional title")

```
ip: 10.10.27.115
子网掩码：255.255.255.0
网络为：10.10.27.0 主机地址为：0.0.0.115
```
