## 量化投资

* 量化基金交易:在这些复杂的衍生品基础上，分析投资标的的价值，然后以某种策略来管理持有仓位，进行买进和卖出
* 专业素养:金融功底、数理逻辑、分析能力、决策能力
* 心理素质的要求也非常高

## 量化投资发展史

* 2008年11月，在金融危机的凄风苦雨中，一场听证会在美国众议院召开，五个西装革履的金融大鳄毕恭毕敬，接受政客们的轮番质询。这5个人都是美国顶级对冲基金的掌门人，分别是量子基金的乔治·索罗斯(George Soros)，文艺复兴的詹姆斯·西蒙斯(James Simons)，保尔森基金的约翰·保尔森(John Paulson)，先驱资本的菲利普·法尔科(Philip Falcone)和城堡投资的肯·格里芬(Ken Griffin)
  - 五个人的共同点是都在金融危机里赚了超过10亿美元，但在听证会上，他们不得不收敛锋芒，试图消除“发国难财”的指责，比如保尔森强调自己的成就是由于“艰苦的工作和详尽的研究”，而法尔科则哽咽地说自己来自贫困的工人阶级家庭，能赚这么多钱纯是因为相信美国梦
  - 巴克莱旗下的Barclays Global Investors（简称BGI）:全球最大的基金管理公司，也被称作是量化投资的大本营。1971年BGI发行了第一只被动指数基金产品，6年后又成立了第一只主动量化权益产品。不仅如此，BGI也是最早将主动量化模型运用在亚洲市场的公司。早在2007年就成立了大中华团队，用数量模型研究A股.由于巴克莱银行收购雷曼兄弟（部分业务）后仍需投入天量资金，于是在2009年6月便以135亿美元将BGI出售给贝莱德（BlackRock），来满足监管机构在一级资本充足率上的要求
    + BGI被收购之后，里面不少中国籍员工回国就业，这似乎是某种蝴蝶效应——在BGI被收购的2009年，中国量化投资的故事也正式展开了
* 这次新冠危机中，他们业绩却有了明显的分化
  - 索罗斯、保尔森和法尔科均遭受了不同程度的损失,均是擅长主动投资
  - 西蒙斯的旗舰基金Medallion今年回报高达29%
  - 格里芬的旗舰基金Wellington也基本没有亏损，顺利躲过股灾
* 量化交易策略（Quantitative Trading Strategies）不依赖于个人判断，而是通过复杂的数学模型来预测投资标的未来价格。经过30多年的发展，量化基金已经逐渐跻身到美国投资市场的主流，而顶尖的量化机构，也都形成了自己鲜明的特色
  - 以AQR为代表的学术量化派，与学术圈深入合作发表大量论文，还专门建了图书馆分享研究成果
  - 以WorldQuant为代表的因子挖掘派，从海量数据中充分挖掘有用的因子
  - 以西蒙斯的Medallion(大奖章)为代表的短线技术派，用数学、物理等科学方法来建立量化模型
* 背后都是海量的数据、复杂的逻辑、神秘的模型，这让量化投资显得高深莫测。2015年作家迈克尔·刘易斯(电影《大空头》的原著作者)撰写了一本阐述高频交易（量化策略的一种）的书《Flash Boy》，好莱坞纷纷表示里面逻辑太深奥，很难拍成电影
* 2004年，国内就先后成立了两只量化基金：光大保德信量化核心基金和上投摩根阿尔法基金。两只基金的掌舵人常昊和吕俊，日后也业界闻名的顶级投资人，但从他们投研理念来看还属于传统价值投资派，更加偏好主动投资，对于量化投资还在自我摸索阶段.加上当时的交易制度不完善，有效投资工具缺乏，量化的真正魔力难以施展。市场更加偏好主动基金，对于投资分散、波动较小的量化基金不屑一顾，随后4年，国内没有任何一只新的量化基金发行。直到2009年，大量拥有海外量化经验的人才纷纷回国，浪潮才真正开始
* 2009年，嘉实量化阿尔法、中海量化策略、长盛量化红利策略、富国沪深300增强和华商动态阿尔法相继成立。其中，曾在BGI担任大中华主动股票投资总监的李笑薇，回国后加盟富国基金，开始着手组建量化团队，将海外积累的量化投资经验应用于中国的金融领域
  - 阿尔法（α）”就是一种重要的量化策略，简单来说任何一只股票的收益等于“α+β”，β是与市场同涨共跌的部分，α是独立于市场波动以外的部分，即一只股票涨了，可能是由于大盘（β）在涨，也可能是因为股票本身的因素（α）
  - α策略也叫市场中性策略，就是把大盘风险（β）对冲掉，不管市场涨得好不好，只留下股票自身的收益，具体的做法可以通过做多股票组合（α+β），同时做空股指期货（-β），最终就剩下了绝对收益α。在没有股指期货这样的做空工具前，市场中性策略是很难实现的
* 不同于主动选股，量化选股的核心在于前期的模型设计环节。策略的设计不能光凭经验和直觉，需要使用大量的历史数据搭建一个模型，再通过各种测试来检验模型是否有效。一旦模型投入使用，就必须严格执行，克服人性弱点和认知偏差。不到特殊情况，不做人工干预
  - 在量化模型中最广泛运用的，是多因子模型。它将影响股票价格的各个因素（比如宏观、行业、流动性、公司基本面、交易情绪等）剥离开来，通过对历史数据的统计分析进行验证，筛选出有效因子，买入满足这些因子的股票。这样就能避免主观盲目，快速覆盖所有股票
* 2010年3月，上交所和深交所开通了融资融券交易系统。半个月后，中金所推出了沪深300股指期货（IF），标志着做空机制与杠杆交易的启蒙，自此我国股票市场不再只有上涨才能盈利，市场下跌不仅可以赚钱，还可以派生出丰富的资产配置策略。这对于量化投资来说是具有里程碑意义的一刻
* 顶级量化私募大多可以分成两类，一类是脱胎于北大、清华、浙大等高校的本土量化，另一类是具有海外投资经验的海归量化
  - 2012年，曾经在BGI担任基金经理的田汉卿和黎海威先后回国，并分别进入华泰柏瑞和景顺长城组建量化团队。而拥有BGI背景的李笑薇、田汉卿、黎海威这三位的投资方向，基本可以囊括当时公募基金的量化策略
  - 2011年，在海外顶级量化机构工作过的任思泓从中金离职，创立了金锝资产
  - 2012年，清华计算机博士毕业的王琛从华尔街的千禧基金回国创业，成立了九坤投资
  - 2013年，毕业于北大物理系的徐晓波从本文开头提到的美国城堡集团回国，创立了锐天投资。
  - 2014年，中金销售交易部副总蔡枚杰创业，成立灵均投资；同年，华尔街的裘慧明回国，创立明汯投资
  - 2015年，包括徐进在内的3个浙大计算机系的同学从IT转向量化投资，成立了幻方量化（九章资产）
* 由于私募的监管相对宽松，组织结构简单，所以交易策略更加灵活、投资更隐蔽，一般来说风险也更高。与公募量化更看重基本面数据不同，私募量化更偏重于量价类，也就是技术面，换仓周期也从公募的一个月一次缩短到几天.私募的量化策略更加丰富
  - 期货策略也就是CTA（管理期货）策略，投资范围包括股指期货、大宗商品期货和国债期货，最经典的做法是捕捉价格动量的趋势性，说人话就是“追涨杀跌”，通过快速止损实现“亏小赢大”的局面
  - 套利量化策略，通过跨市场、跨期限、跨品种去捕捉市场的不合理价差。比如国内大商所的大豆、玉米可以和芝加哥期货交易所的农产品进行跨市场套利；豆油、棕榈油和菜籽油互为替代品，受到季节性气候的影响可能会出现跨品种套利空间；同一品种不同月份的价格强弱变化又可以带来跨期限套利
* 量价策略和基本面策略还有很大的不同。由于A股还是以散户交易为主，私募的量价策略可以捕捉到散户的不理性行为，反向操作即可赚取超额收益，这几年很受到市场追捧，竞争也日益激烈，为了挖掘出超额收益，只能采用更加高频的数据。但在相同市场环境下，换手率越高的策略资金容量越小.因此私募量化也进入了瓶颈期，这两年有多家私募直接暂停所有产品的申购、追加，也有通过提高管理费的方式来控制规模的，还有挂羊头卖狗肉的，对外展示部分惊人业绩的产品，但投资者只能申购普通业绩的产品
* 2014年底的“α黑天鹅”事件。2013年开始，尽管大盘涨幅不大，但以创业板为代表的小盘股起飞，量化基金只要做多创业板，做空IF对冲，就可以获得54%的年化收益[11]。然而2014年11月底，央行宣布降息后股市直冲云霄，小盘股涨幅远不及大盘股，导致超过1/4的α策略产品回撤超过15%，多只产品被迫清盘[12]。
* 2015年中股灾爆发。6月中下旬起，股灾降临使股指期货陷入舆论漩涡。为抑制过度投机、加强异常交易监管，监管层从8月开始逐步加大对股指期货的管控，1个月内连做5次调整，提高交易成本，降低杠杆，日内开仓从不限制调整为限10手，平仓手续费比例较股灾前提高了超过100倍[13]。
* 2016年底市场风格转变，从高估值、小市值的股票转向了基本面扎实、业绩稳定的公司。一些给成长因子、小市值因子给予过高权重的量化基金偃旗息鼓，有过百亿的量化基金遭此一劫一年内规模缩水近六成。
* 后股灾时期，由于缺乏有效的做空工具，股指期货价格不能有效反应市场情况，量化对冲类策略基金受到冲击暂停开仓，CTA策略和量化选股竞争越来越激烈，难复往日之勇，加上小市值因子失效等事件，把蒙了一层神秘面纱的量化基金拉下了神坛，大幅回撤、彻底清盘不在少数。
* 2016-2017年被称作是量化小年，但就在这两年连续有一只量化基金摘取了金牛奖开放式股票型持续优胜基金的桂冠，这一荣誉在业内被誉为是基金行业的奥斯卡。这只量化基金的掌舵人金昉毅十分推崇国外学术量化派代表AQR的学术氛围，因此在加盟光大保德信后，金昉毅要求团队成员每年必须完成一篇学术论文。
* 2018年市场萎靡，上证指数全年下跌25%，主动选股基金几乎全军覆没。量化基金里的指数增强和量化选股也好不到哪里去，唯独市场中性策略因为剥离了大盘（β）风险，一枝独秀。不管大盘表现如何，能够切实为投资者赚到钱，这也是金昉毅做市场中性策略的初心
* 从海外量化的发展历程来看，市场越成熟，越难挖掘α因子，因此也更需要用做学术研究般科学严谨的态度来不断找寻新的因子。而金昉毅正是基于这样的学术态度，才能够顺应潮流，不惧风浪，持续赚取超额收益。光大保德信在2004年推出了国内第一只量化基金后，兜兜转转如今又重新回到一线角逐量化宝座
* 2009年，量化投资在美国全部投资中占30%以上。2018年全球熊市中，最赚钱的20家对冲基金中，有一半以上是量化基金[17]。美国量化经历了几十年的时间，才从幕后走到台前

## Contecpt

* 买（buy）：用美元买入比特币的行为
* 卖（sell）：用比特币换取美元的行为
* 市价单（market order）：给交易所一个方向（买或者卖）和一个数量，交易所把给定数量的美元（或者比特币）换成比特币（或者美元）的单子
  - 在交给交易所后，会立刻得到执行，当然执行价格也并不受你的控制。它很快，但是也非常不安全
* 限价单（limit order）：给交易所一个价格、一个方向（买或者卖）和一个数量，交易所在价格达到给定价格的时候，把给定数量的美元（或者比特币）换成比特币（或者美元）的单子
  - 限定了交易价格和数量，安全性相对高很多。缺点呢，自然就是如果市场朝相反方向走，你挂的单子可能没有任何人去接，也就变成了干吆喝却没人买
* K 线又称“蜡烛线”，是一种反映价格走势的图线。特色在于，一个线段内记录了多项讯息，相当易读易懂且实用有效，因此被广泛用于股票、期货、贵金属、数字货币等行情的技术分析
  - 每一个小蜡烛，都代表着当天的开盘价（Open）、最高价（High）、最低价（Low）和收盘价（Close）
  - 除了日 K 线之外，还有周 K 线、小时 K 线、分钟 K 线等等

## 交易系统

* 行情模块:尝试获取市场的行情数据，通常也负责获取交易账户的状态
* 策略模块:订阅市场的数据，根据设定的算法发出买、卖指令给执行模块
* 执行模块:接受并把策略模块发过来的买、卖指令封装并转发到交易所；同时，监督并确保策略买卖的完整执行
* 回测系统辅助

## Python 在这个行业这么流行

* Python 的数据分析能力。算法交易领域的一个基本需求，就是高效数据处理能力，而数据处理则是 Python 的强项。特别是 NumPy+Pandas 的组合，简直让算法交易开发者的生活质量直线上升
* 大量专有库:有许许多多已经开发成熟的算法交易库可供使用。比如，你可以使用 Zipline 进行策略回测，或者用 Pyfolio 进行投资组合分析。而许多交易所也都提供了基于 Python 的 API 客户端
* 便利的交易平台:有一些算法交易平台可以执行自定义 Python 策略，无需搭建量化交易框架。算法交易平台，实际上等效于帮用户完成了行情模块和执行模块。用户只需要在其中定义策略模块，即可进行算法交易和回测
* Python 本身广泛的行业应用

## 交易所

* 区块链交易所是个撮合交易平台：兼容了传统撮合规则撮合引擎，将资金托管和交割方式替换为区块链
* 数字资产交易所，则是一个中心化的平台，通过 Web 页面或 PC、手机客户端的形式，让用户将数字资产充值到指定钱包地址（交易所创建的钱包），然后在平台挂买单、卖单以实现数字资产之间的兑换
* maker（挂单者）
* taker（吃单者）
* 交易所存在的意义
  - 为 maker 和 taker 提供足够的空间活动
  - 让一个名叫撮合引擎的玩意儿，尽可能地把单子撮合在一起，然后收取一定比例的手续费，从而保障游戏继续进行下去
* 撮合交易:给一个委托列表里加入一个新买入订单，它的价格比所有已有的最高买入价格高，也比所有的卖出价格高。那么此时，它会直接从最低的卖出价格撮合。等到最低价格的卖出订单吃完了，它便开始吃价格第二低的卖出订单，直到这个买入订单完全成交
* 交易所主要有两种行情数据
  - 委托账本（Order Book）
  - 活动行情（Tick data):交易，交易的价格是多少，成交数量是多少
* Spread:最低的卖出价格比最高的买入价格价差

## 量化交易（Quantitative Trading）

* 使用数学、统计甚至机器学习的方法，去找寻合适的买卖时机
* 数字货币
  - 可以在所有的交易所同时进行交易:意味着全球数字货币市场每时每刻都是紧密相连的。一个市场、一个局部的巨大变动，都会影响所有的市场
  - 通常是 7 x 24 小时不眠不休

## 程序化交易（Program Trading）

* 通常用计算机程序代替交易员，来具体执行金融产品的买卖
* 量化交易的下层通常是程序交易

## 高频交易（High Frequency Trading）

## 算法交易（Algo-Trading）

* 常用于高频交易中。指的是，通过算法快速判定买卖的时间点，快速买卖多个产品
* 底层，就是让程序来自动实现这类操作
* API 只是最下层的结构

## 自动化交易平台（Automated Trading System）

## 统计套利（Statistical Arbitrage）

## 回测框架

## Gemini

* 全球首个获得合法经营许可的、首个推出期货合约的、专注于撮合大宗交易的数字货币交易所
* 位于纽约，是一家数字货币交易所和托管机构，允许客户交易和存储数字资产，并直接受纽约州金融服务部门（NYDFS）的监管
* 界面清晰，API 完整而易用，还提供了完整的测试网络 [Gemini Sandbox](https://exchange.sandbox.gemini.com/register)，也就是说，功能和正常的 Gemini 完全一样。但是交易采用虚拟币，非常方便从业者在平台上进行对接测试
* [Gemini](https://docs.gemini.com/rest-api/#private-api-invocatio)

## Bitmex

* API UI 界面和测试网络也是币圈一流
* 是期货交易所

## 接口

* 盈透证券（Interactive Broker）的接口，就可以支持股票、期权的行情数据获取和交易
* OKCoin

```sh
pip install websocket-client
```

## 工具

* 平台
  - Quantopian:提供了基于 Zipline 的标准回测环境
  - BigQuant
  - 果仁网

## 人物

* 陈慧隽

## 参考

* [creative-portfolios](https://github.com/iRaul/creative-portfolios)🌀 A curated list of Creative Portfolios <https://www.creative-portfolios.com/>
* [awesome-quant](https://github.com/thuquant/awesome-quant):中国的Quant相关资源索引
