# QA

## 发展

* 1.0 —— 机械化流水线作业
  - 在各种测试环境中按照详细设计的文档，编写测试用例，并逐条测试，检查功能完整性，发现软件中可能出现的功能缺陷，并进行追踪
* 2.0 —— 过程化带来不同的工作内容和价值体现
  - 用户提出一个功能的时候，测试人员可以快速的进行需求分析，回顾并确定是否与此前的功能有冲突
  - 当开发人员对某一块业务不了解的时候，测试人员也可以组织会议进行阐明】由于对业务和客户的深入了解，测试人员可以为客户提出建设性意见和功能，有时也会是做出决策的人
* 3.0 —— 自动化技能提高生产力
  - 利用工具和程序对测试进行快速的回归，对软件性能进行有效监控，无论是前端还是后端、web应用还是移动平台
* 4.0 —— 角色向多技能、服务化转型
  - 对客户实施怎样的方案，取决于客户的领域、产品/项目特性、用户群、技术水平、政治文化、技术栈以及目标和期望等等

## 团队的质量保障赋能

* 全流程标准化：严格设定整个软件开发流程，流程上每个环节的具体做法都有标准的定义
  - 标准流程：可能包括需求计划、代码审查、静态扫描、动态测试、部署发布、监控等，流程标准化就是定义清楚流程中都有哪些环节，常见的做法就是采用流水线，以及流水线上的标准工具来实现
    + Google 的分布式构建系统 Blaze、基于 Web 的代码评审工具、用于单元测试的 Mocking 框架、缺陷跟踪工具 Buganizer、发布验收审核工具等。
    + Amazon 也有很多称为构建者工具（Builder's tool）供整个软件开发和交付流程使用。所有团队采用同样的系统和工具，对于流程的标准化是很重要的一部分。
    + 有些环节还需要结合规则或者政策进行一定的约束来做到，如代码提交规则、测试覆盖率的要求、失败回滚政策、发布的规则等
      * Amazon 提供模板告诉人们正确的做法，并且采用政策来阻止新人犯错，同时鼓励人们创建更多的政策来优化以找到最优的实践方案，一旦有错误出现就会添加新的相关政策来优化，比如：单元测试覆盖率不能低于 70%、每次部署不允许同时部署到所有区域（Region）等。
      * Google 和 Facebook 也都有类似的一些规则，比如代码必须有一名代码所有者、并且是除作者以外的一人评审通过才能提交。
  - 标准实践：流程外的标准实践主要是针对标准流程以外的一些特定领域或者特定场景下的实践，像针对安全领域的威胁建模、针对微服务架构带来的不确定性的混沌工程等
    + 对安全性要求特别高的 Amazon 则要求所有软件工程师都像安全工程师一样思考，在软件开发初期需要考虑安全模型，并且构建的安全模型需要通过安全专家的评审。
  - 事实标准与书面标准：除了有书面的指标要求，更多的是规定了实现指标的路径，比如：各团队统一的代码仓库管理与严格的代码提交权限，各个环节规定统一工具的使用、统一的模板和政策，使得整个软件开发和交付流程只有一种选择，并且遵循这些规则和路径一定可以实现指标的要求。
* 大规模自动化
  - 测试自动化：自动化测试当然是跟流水线和标准化分不开的，通常流水线上自动化测试不仅有动态的测试脚本执行，也有静态的自动代码扫描。
    + Google、Amazon 和 Facebook 都是对自动化测试要求比较高的，除了单元测试、集成测试、端到端测试外，还都非常关注自动化的性能测试，如负载测试是部署前必须完成的测试。
  - 流程自动化
    + 测试自动化主要是用来验证系统是否按照预期在运行，保证的是软件系统的质量。而流程自动化是保障流程更高效、更正确执行的非常重要的手段。
    + Amazon 提倡的是自动化每一件事情，也就是软件开发流程中所有手动完成的任务都做到自动化完成。这种自动化一切的做法，使得每次代码提交可以直接部署到生产环境，不仅有测试的保证，也不需要人为的干预。构建了很多的检查器（Checker）来检查整个流水线上强制政策执行情况，比如：单元测试覆盖率低于 70%不让提交、AWS 同时部署多个区域会自动中止并自动回滚等。
    + Google 同样有工具自动度量单元测试覆盖率，并且可以通过工具自动地推荐合适的代码评审人员等。
* 所有权（Ownership）：一种可以激励员工内在动力去主动承担质量保障职责的方式
  - Google 和 Facebook 的代码所有权制度，任何人改代码都得有所有者的许可，这对代码质量的保障是很有效的。
  - Facebook 的开发人员需要负责支持所开发产品的运维工作，使得他们更加重视质量。
  - Amazon 是每个小团队负责一个服务，不仅需要负责开发和运维，还需要自行制定需求计划。采用由下往上发起计划的方式，由一线员工去计划接下来的开发内容，因为他们最接近客户、最清楚客户所遇到的问题和真正的需求。这样的方式让增强了工程师的使命感，从而对质量更加重视、更有意愿去把质量搞好。
  - 所有权制度也可能导致跟我们提倡的“团队共同承担质量保障职责”产生矛盾，形成不同的利益群体，真正遇到问题的时候发生“踢皮球”现象。因此，所有权实践也是需要小心谨慎的，注意评估、持续改进很重要，也可以由小团队共同承担所有权职责的方式，或者不同的人或团队轮流承担所有权职责。像 Google 的构建警察，就是由有经验的同事轮流来担任的。
* 标准化、自动化和所有权三者有机结合，是质量保障赋能成功的关键。
  - 标准化和自动化相辅相成，标准化做的好就能更方便的实现自动化，而自动化又是有助于标准化实现的手段。
  - 全面的标准化和自动化使得犯错几率降低，加快了软件交付速度，但同时也可能影响技术人员的能力提升。因此，需要鼓励团队创新，将经验教训固化为新的规则政策，创建新的和优化已有的标准。这些流程实践并不是一成不变的，而是不断演进完善的。
  - 鼓励创新是公司提供的文化氛围，是一种外在的激励因素，而所有权制度是可以激励员工内在动力的方式。
  - 所有权制度也可能带来负面的效果，不仅需要时刻回顾和改进，还务必跟标准化和自动化结合起来，以形成有机整体，尽量减少任何一个实践带来的负面影响。
* ThoughtWorks 实践
  - 测试全流程介入
    + “全程的测试介入”是被写进敏捷测试宣言的一条价值观，测试左移、持续测试和测试右移都是价值观具体的体现。
    + 从赋能的角度来看，敏捷开发团队的 QA 全流程介入，参与多个环节，承担赋能者的职责，起到帮助团队做好质量保障赋能的作用，具体的实践可以总结为以下三个方面的内容。
      * QA 跟不同角色共同制定一系列的模板或者清单，以帮助该角色更清晰的了解到所处环节需要考虑或者完成的事情。这些模板或清单可能是：
      * 需求分析清单/用户故事模板：包括用户故事价值描述、带需求实例的验收条件、性能和安全需求检查点等，以尽量减少需求分析阶段的遗漏点；
      * 完成的定义（Definition of Done，DoD）：清晰定义用户故事开发完成的条件，以帮助开发人员确认用户故事开发过程中需要做的事情；
      * 发布清单：定义发布流程中的任务以及需要注意的点，让发布流程更加顺畅；
      * 线上事故诊断信息收集清单：对于线上事故的诊断，需要第一时间收集哪些相关信息，以帮助更快速的定位问题；
    + 结对或评审（Pair/Review）
      * QA 通过与不同角色的结对，可以把测试技能和对质量的关注意识传递给其他角色，以提高整个团队的整体质量意识。
      * 跟不同角色的结对实践可以有：跟 BA 结拆分用户故事和编写验收条件，跟开发结对拆分任务、实现端到端自动化测试，跟运维结对设定线上监控与分析等。
      * 除了结对，QA 还可以通过评审的方式传递质量意识，比如用户故事、单元测试、日志记录情况的评审等。
    + 质量主题分享或工作坊
      * QA 可以定期跟团队分享质量保障内容，也可以邀请不同角色的同事一起来分享，这些内容可以是：质量保障小知识、项目测试策略与计划、项目质量状态与风险、一些典型 bug 的发现过程或者诊断定位过程。
      * 除了独立的分享以外，还可以通过工作坊的形式邀请团队成员深度参与体验，比如：头脑风暴测试方案、缺陷根因的深度分析、bug 大扫除（bug bash）、生产环境支持策略和流程的改进等。
      * 这样的两种方式，一方面有助于帮助团队普及质量知识和提高质量意识，另一方面让团队不同角色对质量有更深的体会、更强的参与感，从而也就有了更大的责任感，起到赋能的效果。
  - 业务价值驱动测试
    + 交付业务价值是软件开发的根本目的，如果没能清晰理解业务价值，在开发过程中跟业务价值有偏离，将会带来很大的浪费。虽然大家都知道业务价值的重要性，然而业务价值要让整个团队都能很清晰的理解，并不是一件容易的事情。
    + 特别强调业务价值驱动测试，所采取的业务价值驱动的测试实践，有助于将业务价值传递给整个团队，让业务价值跟系统实现和测试紧密关联起来。
  - 缺陷分析
    + 传递业务价值是正向的帮助团队开发正确的软件，而缺陷分析是通过对出现的问题进行详尽的根因分析、反向帮助团队改进的一种实践。失败是成功之母，缺陷分析的重要性和价值不难理解。
    + 缺陷分析不是某个角色独有的职责，需要团队的共同参与，可以让团队不同角色对产品质量状态有更清晰的认识，这是一种有效的质量保障赋能实践。
* 团队质量保障赋能的必要条件
  - 质量目标驱动
    + 要做好质量保障赋能，不仅需要质量目标驱动，很关键的一点是质量目标需要让团队每个人都清楚，并且需要定期回顾，持续调整。
    + 每个阶段团队所有成员都需要清楚：
      * 质量要求（质量目标）是什么？
      * 当前状态怎么样？
      * 需要做哪些调整以更好的实现目标？
  - 测试策略指导
    + 测试策略是质量保障的指南，为了让测试策略真正发挥价值，并且团队每个成员都能对测试策略有清晰的了解，推荐《一页纸测试策略》。
    + 一页纸策略图只是策略的总览，背后需要大量的沟通和协作，更加有利于团队质量保障赋能，增强团队成员的质量意识。
  - QA 职责转变
    + 职责
      * QA = Quality Assurance 质量保障第一个层次 QA 的要求是做好质量保障工作，确保我们交付给客户的软件产品是正常工作的。
      * QA = Quality Analyst 质量分析第二个层次的 QA 通过测试、数据收集的方式，分析系统的质量，识别风险，并反馈给团队，和团队所有成员一起确保交付的质量是合格的。
      * QA = Quality Advocate 质量倡导者第三个层次的 QA 不再局限于只关注质量，通过培养对产品和流程持续改进的思维模式、了解产品的整体质量视图和持续关注产品质量的意识，引导整个团队构建正确的产品，并且正确地构建产品。
    + QA 只有从认知上做好转变，不再是简单测试人员的思维，才能更好的承担起这个艰巨的赋能任务。
* 价值观
  - 交付价值：敏捷特别强调价值的持续和尽早交付，因此，团队所有角色对价值的理解、业务价值在团队的传递非常重要。
  - 质量内建：质量内建通过测试左移、多个角色的合作，在缺陷暴露之前做到提前预防，将质量构建在软件系统里。
  - 快速反馈：快速反馈就是要做到软件开发生命周期的每个环节都能收到反馈，需要加强每个环节的测试相关活动和大量自动化测试的覆盖。

## 图书

* 敏捷软件测试 Lisa Crispin
